
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Muslim Reminder</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body.dark { background-color: #111827; color: white; }
    .hidden { display: none; }
  </style>
</head>
<body class="bg-white text-gray-800 transition-colors duration-300">
  <div class="max-w-2xl mx-auto p-4">
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-2xl font-bold">Muslim Reminder</h1>
      <button id="toggleDark" class="px-4 py-2 bg-indigo-600 text-white rounded">Dark Mode</button>
    </div>

    <div id="prayerTimes" class="mb-6 p-4 bg-gray-100 rounded shadow">
      <h2 class="text-xl font-semibold mb-2">Prayer Times</h2>
      <div id="times">Loading...</div>
    </div>

    <div id="nextPrayer" class="mb-6 p-4 bg-yellow-100 rounded shadow">
      <h2 class="text-xl font-semibold mb-2">Next Prayer Countdown</h2>
      <div id="countdown">Calculating...</div>
    </div>

    <div id="dailyAyah" class="mb-6 p-4 bg-green-100 rounded shadow">
      <h2 class="text-xl font-semibold mb-2">Daily Ayah</h2>
      <div id="ayah">Loading...</div>
    </div>

    <div id="dailyDoa" class="p-4 bg-blue-100 rounded shadow">
      <h2 class="text-xl font-semibold mb-2">Daily Doa</h2>
      <ul class="list-disc ml-5 space-y-1">
        <li onclick="showDoa('Bangun Tidur')">Doa Bangun Tidur</li>
        <li onclick="showDoa('Masuk WC')">Doa Masuk WC</li>
        <li onclick="showDoa('Keluar WC')">Doa Keluar WC</li>
      </ul>
      <div id="doaContent" class="mt-4"></div>
    </div>
  </div>

<script>
document.getElementById("toggleDark").onclick = () => {
  document.body.classList.toggle("dark");
};

const doaMap = {
  "Bangun Tidur": "Alhamdulillahilladzi ahyana ba'da ma amatana wa ilaihin nusyur.",
  "Masuk WC": "Allahumma inni a'udzu bika minal khubutsi wal khabaaits.",
  "Keluar WC": "Ghufraanaka."
};

function showDoa(name) {
  document.getElementById("doaContent").innerText = doaMap[name] || "";
}

navigator.geolocation.getCurrentPosition(async pos => {
  const lat = pos.coords.latitude;
  const lon = pos.coords.longitude;
  const res = await fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=4`);
  const data = await res.json();
  const times = data.data.timings;
  let html = '';
  for (let key in times) html += `<div><b>${key}</b>: ${times[key]}</div>`;
  document.getElementById("times").innerHTML = html;

  const now = new Date();
  const upcoming = Object.entries(times).find(([k, v]) => {
    const t = new Date(); const [h, m] = v.split(":");
    t.setHours(h); t.setMinutes(m); t.setSeconds(0);
    return t > now;
  });
  if (upcoming) {
    const [name, time] = upcoming;
    const [h, m] = time.split(":");
    const target = new Date(); target.setHours(h, m, 0);
    const updateCountdown = () => {
      const diff = Math.max(0, target - new Date());
      const mins = Math.floor(diff / 60000); const secs = Math.floor((diff % 60000) / 1000);
      document.getElementById("countdown").innerText = `${name} in ${mins}m ${secs}s`;
    };
    updateCountdown(); setInterval(updateCountdown, 1000);
  }
});

fetch("https://api.alquran.cloud/v1/ayah/262/en.asad")
  .then(res => res.json())
  .then(d => document.getElementById("ayah").innerText = `${d.data.text} â€” [${d.data.surah.englishName} : ${d.data.numberInSurah}]`);
</script>
</body>
</html>
